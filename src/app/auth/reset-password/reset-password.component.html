<div class="reset-password-container" [class.fade-out]="resetSuccess">
  <div class="reset-password-wrapper">
    <div class="blob blob-1"></div>
    <div class="blob blob-2"></div>

    <div class="reset-password-card" [class.success-animation]="resetSuccess">
      <!-- Success Overlay -->
      <div class="success-overlay" *ngIf="resetSuccess">
        <div class="success-icon">
          <i class="fas fa-check-circle"></i>
        </div>
        <h3>تم تغيير كلمة المرور بنجاح!</h3>
        <p>جاري التحويل إلى صفحة تسجيل الدخول...</p>
      </div>

      <div class="reset-password-header">
        <div class="logo-container">
          <img src="/assets/images/OmegaLogo.png" alt="شعار الشركة" class="company-logo">
        </div>
        <h1>إعادة تعيين كلمة المرور</h1>
        <p>أدخل كلمة المرور الجديدة</p>
      </div>

      <div class="error-alert" *ngIf="errorMessage">
        <i class="fas fa-exclamation-circle"></i>
        <span>{{ errorMessage }}</span>
      </div>

      <form [formGroup]="resetPasswordForm" (ngSubmit)="onSubmit()" class="reset-password-form">
        <div class="form-group">
          <label for="newPassword">
            <i class="fas fa-lock"></i>
            كلمة المرور الجديدة
          </label>
          <div class="password-input-wrapper">
            <input
              [type]="showPassword ? 'text' : 'password'"
              id="newPassword"
              formControlName="newPassword"
              placeholder="أدخل كلمة المرور الجديدة"
              [class.error]="hasError('newPassword', 'required') || hasError('newPassword', 'minlength')"
              autocomplete="new-password"
            />
            <button
              type="button"
              class="toggle-password"
              (click)="togglePasswordVisibility('password')"
              tabindex="-1"
              aria-label="إظهار/إخفاء كلمة المرور"
            >
              <i [class]="showPassword ? 'fas fa-eye-slash' : 'fas fa-eye'"></i>
            </button>
          </div>
          <small class="error-message" *ngIf="getErrorMessage('newPassword')">
            {{ getErrorMessage('newPassword') }}
          </small>
        </div>

        <div class="form-group">
          <label for="confirmPassword">
            <i class="fas fa-lock"></i>
            تأكيد كلمة المرور
          </label>
          <div class="password-input-wrapper">
            <input
              [type]="showConfirmPassword ? 'text' : 'password'"
              id="confirmPassword"
              formControlName="confirmPassword"
              placeholder="أعد إدخال كلمة المرور"
              [class.error]="hasError('confirmPassword', 'required') || hasError('confirmPassword', 'passwordMismatch')"
              autocomplete="new-password"
            />
            <button
              type="button"
              class="toggle-password"
              (click)="togglePasswordVisibility('confirm')"
              tabindex="-1"
              aria-label="إظهار/إخفاء كلمة المرور"
            >
              <i [class]="showConfirmPassword ? 'fas fa-eye-slash' : 'fas fa-eye'"></i>
            </button>
          </div>
          <small class="error-message" *ngIf="getErrorMessage('confirmPassword')">
            {{ getErrorMessage('confirmPassword') }}
          </small>
        </div>

        <button type="submit" class="submit-btn" [disabled]="loading || resetSuccess">
          <span *ngIf="!loading && !resetSuccess">
            <i class="fas fa-key"></i>
            إعادة تعيين كلمة المرور
          </span>
          <span *ngIf="loading && !resetSuccess" class="loading-spinner">
            <i class="fas fa-spinner fa-spin"></i>
            جاري الحفظ...
          </span>
          <span *ngIf="resetSuccess" class="success-spinner">
            <i class="fas fa-check-circle"></i>
            تم بنجاح!
          </span>
        </button>

        <div class="form-footer">
          <button type="button" class="back-to-login-btn" (click)="goToLogin()" [disabled]="loading">
            <i class="fas fa-arrow-left"></i>
            العودة إلى تسجيل الدخول
          </button>
        </div>
      </form>

      <div class="reset-password-footer">
        <p>© {{ currentYear }} نظام أوميجا. جميع الحقوق محفوظة</p>
      </div>
    </div>
  </div>
</div>
