<div class="secretariat-user-container">

  <!-- TOAST NOTIFICATIONS CONTAINER -->
  <div class="toast-container" [attr.dir]="formLanguage === 'ar' ? 'rtl' : 'ltr'">
    <div
      *ngFor="let toast of toasts"
      class="toast"
      [class.toast-success]="toast.type === 'success'"
      [class.toast-error]="toast.type === 'error'"
      [class.toast-info]="toast.type === 'info'"
      [class.toast-warning]="toast.type === 'warning'">

      <div class="toast-icon">
        <i class="bi"
           [ngClass]="{
             'bi-check-circle-fill': toast.type === 'success',
             'bi-x-circle-fill': toast.type === 'error',
             'bi-info-circle-fill': toast.type === 'info',
             'bi-exclamation-triangle-fill': toast.type === 'warning'
           }"></i>
      </div>

      <div class="toast-content">
        <p class="toast-message">{{ toast.message }}</p>
      </div>

      <button class="toast-close" (click)="removeToast(toast.id)">
        <i class="bi bi-x"></i>
      </button>
    </div>
  </div>

  <!-- ============================================ -->
  <!-- LIST VIEW -->
  <!-- ============================================ -->
  <div *ngIf="currentView === 'list'" class="list-view">
    <!-- Header -->
    <div class="page-header">
      <h1 class="page-title">{{ formLanguage === 'ar' ? 'نماذجي' : 'My Forms' }}</h1>
      <div class="header-actions">
        <button class="btn-primary" (click)="createNewForm()">
          <i class="bi bi-plus-lg"></i>
          {{ formLanguage === 'ar' ? 'إنشاء نموذج جديد' : 'Create New Form' }}
        </button>
      </div>
    </div>

    <!-- Info Banner -->
    <div class="info-banner" [attr.dir]="formLanguage === 'ar' ? 'rtl' : 'ltr'">
      <i class="bi bi-info-circle"></i>
      <div class="info-content">
        <p class="info-title">{{ formLanguage === 'ar' ? 'ملاحظة هامة' : 'Important Note' }}</p>
        <p class="info-text">
          {{ formLanguage === 'ar'
            ? 'عند إنشاء نموذج جديد، سيتم إرسال إشعار تلقائي إلى السكرتارية وإرسال نسخة عبر البريد الإلكتروني.'
            : 'When you create a new form, a notification will be automatically sent to the secretariat and a copy will be emailed.'
          }}
        </p>
      </div>
    </div>

    <!-- Filters -->
    <div class="filters-section" [attr.dir]="formLanguage === 'ar' ? 'rtl' : 'ltr'">
      <div class="filter-group">
        <select
          class="filter-select"
          [(ngModel)]="selectedFormType"
          (ngModelChange)="onFilterChange()">
          <option value="">{{ formLanguage === 'ar' ? 'جميع الأنواع' : 'All Types' }}</option>
          <option *ngFor="let type of formTypes" [value]="type.value">
            {{ formLanguage === 'ar' ? type.label : getFormTypeLabelEn(type.value) }}
          </option>
        </select>

        <select
          class="filter-select"
          [(ngModel)]="selectedStatus"
          (ngModelChange)="onFilterChange()">
          <option value="">{{ formLanguage === 'ar' ? 'جميع الحالات' : 'All Statuses' }}</option>
          <option value="pending">{{ formLanguage === 'ar' ? 'قيد الانتظار' : 'Pending' }}</option>
          <option value="approved">{{ formLanguage === 'ar' ? 'معتمد' : 'Approved' }}</option>
          <option value="rejected">{{ formLanguage === 'ar' ? 'مرفوض' : 'Rejected' }}</option>
        </select>

        <button class="btn-clear-filters" (click)="clearFilters()" *ngIf="selectedFormType || selectedStatus">
          <i class="bi bi-x-circle"></i>
          {{ formLanguage === 'ar' ? 'مسح الفلاتر' : 'Clear Filters' }}
        </button>
      </div>
    </div>

    <!-- Table -->
    <div class="table-container">
      <table class="forms-table">
        <thead>
          <tr>
            <th class="text-center">{{ formLanguage === 'ar' ? 'الإجراءات' : 'Actions' }}</th>
            <th class="text-center">{{ formLanguage === 'ar' ? 'رقم النموذج' : 'Form #' }}</th>
            <th class="text-center">{{ formLanguage === 'ar' ? 'نوع النموذج' : 'Form Type' }}</th>
            <th class="text-center">{{ formLanguage === 'ar' ? 'التاريخ' : 'Date' }}</th>
            <th class="text-center">{{ formLanguage === 'ar' ? 'الحالة' : 'Status' }}</th>
            <th class="text-center">{{ formLanguage === 'ar' ? 'تاريخ الإنشاء' : 'Created At' }}</th>
          </tr>
        </thead>
        <tbody *ngIf="!loading && forms.length > 0">
          <tr *ngFor="let form of forms">
            <td class="actions-cell text-center">
              <button
                class="btn-icon btn-view"
                (click)="viewPDF(form)"
                [title]="formLanguage === 'ar' ? 'عرض PDF' : 'View PDF'">
                <i class="bi bi-eye"></i>
              </button>
              <button
                class="btn-icon btn-print"
                (click)="printPDF(form)"
                [title]="formLanguage === 'ar' ? 'طباعة' : 'Print'">
                <i class="bi bi-printer"></i>
              </button>
              <button
                class="btn-icon btn-download"
                (click)="downloadPDF(form)"
                [title]="formLanguage === 'ar' ? 'تحميل PDF' : 'Download PDF'">
                <i class="bi bi-download"></i>
              </button>
            </td>
            <td class="form-number text-center">{{ form.formNumber }}</td>
            <td class="text-center">
              <div class="form-type-badge" [style.background]="getFormTypeColor(form.formType) + '20'" [style.color]="getFormTypeColor(form.formType)">
                <i class="bi" [ngClass]="getFormTypeIcon(form.formType)"></i>
                <span>{{ getFormTypeLabel(form.formType) }}</span>
              </div>
            </td>
            <td class="text-center">{{ formatDate(form.date) }}</td>
            <td class="text-center">
              <span class="status-badge" [ngClass]="getStatusColor(form.status)">
                {{ getStatusLabel(form.status) }}
              </span>
            </td>
            <td class="text-center">{{ formatDate(form.createdAt) }}</td>
          </tr>
        </tbody>
        <tbody *ngIf="loading">
          <tr>
            <td colspan="6" class="text-center loading-cell">
              <i class="bi bi-arrow-clockwise spin"></i> {{ formLanguage === 'ar' ? 'جاري التحميل...' : 'Loading...' }}
            </td>
          </tr>
        </tbody>
        <tbody *ngIf="!loading && forms.length === 0">
          <tr>
            <td colspan="6" class="text-center empty-cell">
              <div class="empty-state">
                <i class="bi bi-inbox"></i>
                <p>{{ formLanguage === 'ar' ? 'لا توجد نماذج' : 'No forms found' }}</p>
                <button class="btn-create-first" (click)="createNewForm()">
                  <i class="bi bi-plus-circle"></i>
                  {{ formLanguage === 'ar' ? 'إنشاء أول نموذج' : 'Create First Form' }}
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Pagination -->
    <div class="pagination" *ngIf="totalPages > 1">
      <button
        class="btn-page"
        [disabled]="currentPage === 1"
        (click)="goToPage(currentPage - 1)">
        <i class="bi bi-chevron-left"></i>
      </button>

      <span class="page-info">
        {{ formLanguage === 'ar' ? 'صفحة' : 'Page' }} {{ currentPage }} {{ formLanguage === 'ar' ? 'من' : 'of' }} {{ totalPages }}
      </span>

      <button
        class="btn-page"
        [disabled]="currentPage === totalPages"
        (click)="goToPage(currentPage + 1)">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </div>

  <!-- ============================================ -->
  <!-- CREATE VIEW -->
  <!-- ============================================ -->
  <div *ngIf="currentView === 'create'" class="form-view" [attr.dir]="formLanguage === 'ar' ? 'rtl' : 'ltr'">
    <!-- Header -->
    <div class="form-header">
      <h1 class="form-title">
        {{ formLanguage === 'ar' ? 'إنشاء نموذج جديد' : 'Create New Form' }}
      </h1>
      <div class="form-actions">
        <button class="btn-secondary" (click)="backToList()">
          {{ formLanguage === 'ar' ? 'إلغاء' : 'Cancel' }}
        </button>
        <button
          class="btn-primary"
          (click)="saveForm()"
          [disabled]="creatingForm">
          <i class="bi bi-save"></i>
          {{ creatingForm
            ? (formLanguage === 'ar' ? 'جاري الحفظ...' : 'Saving...')
            : (formLanguage === 'ar' ? 'حفظ' : 'Save')
          }}
        </button>
      </div>
    </div>

    <!-- Error Alert -->
    <div class="error-alert" *ngIf="formError">
      <i class="bi bi-exclamation-circle"></i>
      <span>{{ formError }}</span>
    </div>

    <!-- Form Content -->
    <div class="form-content">
      <!-- Form Type Selection -->
      <div class="form-section">
        <h2 class="section-title">
          {{ formLanguage === 'ar' ? 'اختر نوع النموذج' : 'Select Form Type' }}
          <span class="required">*</span>
        </h2>

        <div class="form-types-grid">
          <div
            *ngFor="let type of formTypes"
            class="form-type-card"
            [class.selected]="formData.formType === type.value"
            (click)="selectFormType(type.value)">
            <div class="card-icon" [style.background]="type.color + '20'" [style.color]="type.color">
              <i class="bi" [ngClass]="type.icon"></i>
            </div>
            <h3 class="card-title">{{ formLanguage === 'ar' ? type.label : getFormTypeLabelEn(type.value) }}</h3>
            <p class="card-code">{{ type.code }}</p>
            <div class="card-checkmark" *ngIf="formData.formType === type.value">
              <i class="bi bi-check-circle-fill"></i>
            </div>
          </div>
        </div>

        <small class="error-message" *ngIf="fieldErrors['formType']">
          <i class="bi bi-exclamation-circle"></i>
          {{ fieldErrors['formType'] }}
        </small>
      </div>

      <!-- Manual Data Section - Shows automatically and dynamically based on form type -->
      <div class="manual-inputs-section" *ngIf="formData.formType" [@slideIn]>
        <div class="manual-section-header">
          <h3 class="manual-section-title">
            <i class="bi bi-pencil-square"></i>
            {{ formLanguage === 'ar' ? 'بيانات النموذج' : 'Form Data' }}
          </h3>
          <p class="manual-section-subtitle">
            {{ formLanguage === 'ar'
              ? 'املأ البيانات المطلوبة. بعض الحقول تُملأ تلقائياً من حسابك.'
              : 'Fill in the required data. Some fields are auto-filled from your account.'
            }}
          </p>
        </div>

        <!-- Departure Form Fields -->
        <div class="form-section" *ngIf="isDepartureForm()" [@slideIn]>
          <h4 class="subsection-title">
            <i class="bi bi-box-arrow-right"></i>
            {{ formLanguage === 'ar' ? 'بيانات المغادرة' : 'Departure Details' }}
          </h4>

          <!-- Auto-filled: Employee Name (read-only display) -->
          <div class="form-group">
            <label>
              <i class="bi bi-person"></i>
              {{ formLanguage === 'ar' ? 'اسم الموظف' : 'Employee Name' }}
              <span class="auto-badge">{{ formLanguage === 'ar' ? 'تلقائي' : 'Auto' }}</span>
            </label>
            <input
              type="text"
              class="form-control auto-filled"
              [value]="currentUser?.name"
              readonly
              disabled
            />
            <small class="field-hint">
              <i class="bi bi-check-circle-fill"></i>
              {{ formLanguage === 'ar' ? 'يُملأ تلقائياً من حسابك' : 'Auto-filled from your account' }}
            </small>
          </div>

          <!-- Auto-filled: Date (auto-set to today) -->
          <div class="form-group">
            <label>
              <i class="bi bi-calendar"></i>
              {{ formLanguage === 'ar' ? 'تاريخ التعبئة' : 'Date' }}
              <span class="auto-badge">{{ formLanguage === 'ar' ? 'تلقائي' : 'Auto' }}</span>
            </label>
            <input
              type="date"
              class="form-control auto-filled"
              [(ngModel)]="formData.date"
              readonly
            />
            <small class="field-hint">
              <i class="bi bi-check-circle-fill"></i>
              {{ formLanguage === 'ar' ? 'يُملأ تلقائياً بتاريخ اليوم' : 'Auto-filled with today\'s date' }}
            </small>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>
                <i class="bi bi-briefcase"></i>
                {{ formLanguage === 'ar' ? 'المنصب' : 'Position' }}
              </label>
              <input
                type="text"
                class="form-control"
                [(ngModel)]="manualData.position"
                [placeholder]="formLanguage === 'ar' ? 'أدخل المنصب' : 'Enter position'"
              />
            </div>

            <div class="form-group">
              <label>
                <i class="bi bi-building"></i>
                {{ formLanguage === 'ar' ? 'القسم' : 'Department' }}
              </label>
              <input
                type="text"
                class="form-control"
                [(ngModel)]="manualData.department"
                [placeholder]="formLanguage === 'ar' ? 'أدخل القسم' : 'Enter department'"
              />
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>
                <i class="bi bi-clock"></i>
                {{ formLanguage === 'ar' ? 'الساعة من' : 'Time From' }}
              </label>
              <input
                type="time"
                class="form-control"
                [(ngModel)]="manualData.departureTime"
              />
            </div>

            <div class="form-group">
              <label>
                <i class="bi bi-clock-fill"></i>
                {{ formLanguage === 'ar' ? 'الساعة إلى' : 'Time To' }}
              </label>
              <input
                type="time"
                class="form-control"
                [(ngModel)]="manualData.returnTime"
              />
            </div>
          </div>

          <div class="form-group">
            <label>
              <i class="bi bi-card-text"></i>
              {{ formLanguage === 'ar' ? 'سبب المغادرة' : 'Departure Reason' }}
            </label>
            <textarea
              class="form-control"
              [(ngModel)]="manualData.purpose"
              rows="4"
              [placeholder]="formLanguage === 'ar' ? 'أدخل سبب المغادرة' : 'Enter departure reason'"
            ></textarea>
          </div>
        </div>

        <!-- Vacation Form Fields -->
        <div class="form-section" *ngIf="isVacationForm()" [@slideIn]>
          <h4 class="subsection-title">
            <i class="bi bi-calendar-event"></i>
            {{ formLanguage === 'ar' ? 'بيانات الإجازة' : 'Vacation Details' }}
          </h4>

          <!-- Auto-filled: Employee Name -->
          <div class="form-group">
            <label>
              <i class="bi bi-person"></i>
              {{ formLanguage === 'ar' ? 'اسم الموظف' : 'Employee Name' }}
              <span class="auto-badge">{{ formLanguage === 'ar' ? 'تلقائي' : 'Auto' }}</span>
            </label>
            <input
              type="text"
              class="form-control auto-filled"
              [value]="currentUser?.name"
              readonly
              disabled
            />
            <small class="field-hint">
              <i class="bi bi-check-circle-fill"></i>
              {{ formLanguage === 'ar' ? 'يُملأ تلقائياً من حسابك' : 'Auto-filled from your account' }}
            </small>
          </div>

          <!-- Auto-filled: Date -->
          <div class="form-group">
            <label>
              <i class="bi bi-calendar"></i>
              {{ formLanguage === 'ar' ? 'تاريخ تعبئة النموذج' : 'Form Date' }}
              <span class="auto-badge">{{ formLanguage === 'ar' ? 'تلقائي' : 'Auto' }}</span>
            </label>
            <input
              type="date"
              class="form-control auto-filled"
              [(ngModel)]="formData.date"
              readonly
            />
            <small class="field-hint">
              <i class="bi bi-check-circle-fill"></i>
              {{ formLanguage === 'ar' ? 'يُملأ تلقائياً بتاريخ اليوم' : 'Auto-filled with today\'s date' }}
            </small>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>
                <i class="bi bi-briefcase"></i>
                {{ formLanguage === 'ar' ? 'المنصب' : 'Position' }}
              </label>
              <input
                type="text"
                class="form-control"
                [(ngModel)]="manualData.position"
                [placeholder]="formLanguage === 'ar' ? 'أدخل المنصب' : 'Enter position'"
              />
            </div>

            <div class="form-group">
              <label>
                <i class="bi bi-building"></i>
                {{ formLanguage === 'ar' ? 'القسم' : 'Department' }}
              </label>
              <input
                type="text"
                class="form-control"
                [(ngModel)]="manualData.department"
                [placeholder]="formLanguage === 'ar' ? 'أدخل القسم' : 'Enter department'"
              />
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>
                <i class="bi bi-calendar-date"></i>
                {{ formLanguage === 'ar' ? 'من تاريخ' : 'From Date' }}
              </label>
              <input
                type="date"
                class="form-control"
                [(ngModel)]="manualData.startDate"
              />
            </div>

            <div class="form-group">
              <label>
                <i class="bi bi-calendar-check"></i>
                {{ formLanguage === 'ar' ? 'إلى تاريخ' : 'To Date' }}
              </label>
              <input
                type="date"
                class="form-control"
                [(ngModel)]="manualData.endDate"
              />
            </div>
          </div>

          <div class="form-group">
            <label>
              <i class="bi bi-card-list"></i>
              {{ formLanguage === 'ar' ? 'نوع الإجازة' : 'Vacation Type' }}
            </label>
            <select class="form-control" [(ngModel)]="manualData.vacationType">
              <option value="">{{ formLanguage === 'ar' ? 'اختر نوع الإجازة' : 'Select vacation type' }}</option>
              <option value="annual">{{ formLanguage === 'ar' ? 'إجازة سنوية' : 'Annual Leave' }}</option>
              <option value="sick">{{ formLanguage === 'ar' ? 'إجازة مرضية' : 'Sick Leave' }}</option>
              <option value="emergency">{{ formLanguage === 'ar' ? 'إجازة طارئة' : 'Emergency Leave' }}</option>
              <option value="unpaid">{{ formLanguage === 'ar' ? 'إجازة بدون راتب' : 'Unpaid Leave' }}</option>
            </select>
          </div>

          <div class="form-group">
            <label>
              <i class="bi bi-card-text"></i>
              {{ formLanguage === 'ar' ? 'سبب الإجازة' : 'Vacation Reason' }}
            </label>
            <textarea
              class="form-control"
              [(ngModel)]="manualData.reason"
              rows="4"
              [placeholder]="formLanguage === 'ar' ? 'أدخل سبب الإجازة' : 'Enter vacation reason'"
            ></textarea>
          </div>
        </div>

        <!-- Advance Form Fields -->
        <div class="form-section" *ngIf="isAdvanceForm()" [@slideIn]>
          <h4 class="subsection-title">
            <i class="bi bi-cash-coin"></i>
            {{ formLanguage === 'ar' ? 'بيانات السلفة' : 'Advance Details' }}
          </h4>

          <!-- Auto-filled: Employee Name -->
          <div class="form-group">
            <label>
              <i class="bi bi-person"></i>
              {{ formLanguage === 'ar' ? 'اسم الموظف' : 'Employee Name' }}
              <span class="auto-badge">{{ formLanguage === 'ar' ? 'تلقائي' : 'Auto' }}</span>
            </label>
            <input
              type="text"
              class="form-control auto-filled"
              [value]="currentUser?.name"
              readonly
              disabled
            />
            <small class="field-hint">
              <i class="bi bi-check-circle-fill"></i>
              {{ formLanguage === 'ar' ? 'يُملأ تلقائياً من حسابك' : 'Auto-filled from your account' }}
            </small>
          </div>

          <!-- Auto-filled: Date -->
          <div class="form-group">
            <label>
              <i class="bi bi-calendar"></i>
              {{ formLanguage === 'ar' ? 'تاريخ تعبئة النموذج' : 'Form Date' }}
              <span class="auto-badge">{{ formLanguage === 'ar' ? 'تلقائي' : 'Auto' }}</span>
            </label>
            <input
              type="date"
              class="form-control auto-filled"
              [(ngModel)]="formData.date"
              readonly
            />
            <small class="field-hint">
              <i class="bi bi-check-circle-fill"></i>
              {{ formLanguage === 'ar' ? 'يُملأ تلقائياً بتاريخ اليوم' : 'Auto-filled with today\'s date' }}
            </small>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>
                <i class="bi bi-briefcase"></i>
                {{ formLanguage === 'ar' ? 'المنصب' : 'Position' }}
              </label>
              <input
                type="text"
                class="form-control"
                [(ngModel)]="manualData.position"
                [placeholder]="formLanguage === 'ar' ? 'أدخل المنصب' : 'Enter position'"
              />
            </div>

            <div class="form-group">
              <label>
                <i class="bi bi-building"></i>
                {{ formLanguage === 'ar' ? 'القسم' : 'Department' }}
              </label>
              <input
                type="text"
                class="form-control"
                [(ngModel)]="manualData.department"
                [placeholder]="formLanguage === 'ar' ? 'أدخل القسم' : 'Enter department'"
              />
            </div>
          </div>

          <div class="form-group">
            <label>
              <i class="bi bi-currency-exchange"></i>
              {{ formLanguage === 'ar' ? 'مبلغ السلفة (دينار)' : 'Advance Amount (Dinar)' }}
            </label>
            <input
              type="number"
              class="form-control"
              [(ngModel)]="manualData.advanceAmount"
              min="0"
              step="0.01"
              [placeholder]="formLanguage === 'ar' ? 'أدخل المبلغ' : 'Enter amount'"
            />
          </div>

          <div class="form-group">
            <label>
              <i class="bi bi-card-text"></i>
              {{ formLanguage === 'ar' ? 'سبب السلفة' : 'Advance Reason' }}
            </label>
            <textarea
              class="form-control"
              [(ngModel)]="manualData.advanceReason"
              rows="4"
              [placeholder]="formLanguage === 'ar' ? 'أدخل سبب السلفة' : 'Enter advance reason'"
            ></textarea>
          </div>

          <div class="form-group">
            <label>
              <i class="bi bi-wallet2"></i>
              {{ formLanguage === 'ar' ? 'طريقة السداد' : 'Repayment Method' }}
            </label>
            <select class="form-control" [(ngModel)]="manualData.repaymentMethod">
              <option value="">{{ formLanguage === 'ar' ? 'اختر طريقة السداد' : 'Select repayment method' }}</option>
              <option value="salary_deduction">{{ formLanguage === 'ar' ? 'خصم من الراتب' : 'Salary Deduction' }}</option>
              <option value="cash">{{ formLanguage === 'ar' ? 'نقداً' : 'Cash' }}</option>
              <option value="other">{{ formLanguage === 'ar' ? 'أخرى' : 'Other' }}</option>
            </select>
          </div>
        </div>


      </div>

      <!-- Email Notification Info -->
      <div class="notification-info" *ngIf="formData.formType">
        <i class="bi bi-envelope-check"></i>
        <div class="notification-content">
          <p class="notification-title">
            {{ formLanguage === 'ar' ? 'إشعار تلقائي' : 'Automatic Notification' }}
          </p>
          <p class="notification-text">
            {{ formLanguage === 'ar'
              ? 'سيتم إرسال إشعار للسكرتارية ونسخة عبر البريد الإلكتروني'
              : 'A notification will be sent to the secretariat and a copy via email'
            }}
          </p>
        </div>
      </div>

      <!-- Save Button -->
      <div class="save-section" *ngIf="formData.formType">
        <button
          class="btn-save-form"
          (click)="saveForm()"
          [disabled]="creatingForm">
          <i class="bi" [ngClass]="creatingForm ? 'bi-arrow-clockwise spin' : 'bi-file-earmark-pdf'"></i>
          {{ creatingForm
            ? (formLanguage === 'ar' ? 'جاري إنشاء النموذج...' : 'Creating Form...')
            : (formLanguage === 'ar' ? 'حفظ وإنشاء النموذج' : 'Save & Generate Form')
          }}
        </button>
        <p class="save-hint">
          {{ formLanguage === 'ar'
            ? 'سيتم إنشاء ملف PDF تلقائياً وإرسال الإشعارات'
            : 'PDF will be automatically generated and notifications will be sent'
          }}
        </p>
      </div>
    </div>
  </div>

  <!-- ============================================ -->
  <!-- SUCCESS MODAL (PDF Generated) -->
  <!-- ============================================ -->
  <div class="modal-overlay" *ngIf="showSuccessModal" (click)="closeSuccessModal()">
    <div class="modal-content modal-success" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2 class="modal-title">
          <i class="bi bi-check-circle-fill text-success"></i>
          {{ formLanguage === 'ar' ? 'تم إنشاء النموذج بنجاح!' : 'Form Created Successfully!' }}
        </h2>
        <button class="modal-close" (click)="closeSuccessModal()">
          <i class="bi bi-x-lg"></i>
        </button>
      </div>

      <div class="modal-body">
        <div class="success-icon">
          <i class="bi bi-file-earmark-pdf-fill"></i>
        </div>
        <p class="success-message">
          {{ formLanguage === 'ar'
            ? 'تم إنشاء ملف PDF بنجاح وإرسال الإشعار للسكرتارية. ماذا تريد أن تفعل؟'
            : 'PDF has been generated successfully and notification sent to secretariat. What would you like to do?'
          }}
        </p>

        <div class="notification-sent">
          <i class="bi bi-send-check-fill"></i>
          <span>
            {{ formLanguage === 'ar'
              ? 'تم إرسال إشعار للسكرتارية ونسخة عبر البريد الإلكتروني'
              : 'Notification sent to secretariat and email copy sent'
            }}
          </span>
        </div>

        <div class="action-buttons">
          <button class="btn-action btn-view" (click)="viewGeneratedPDF(); closeSuccessModal()">
            <i class="bi bi-eye-fill"></i>
            <span>{{ formLanguage === 'ar' ? 'عرض PDF' : 'View PDF' }}</span>
          </button>

          <button class="btn-action btn-print" (click)="printGeneratedPDF(); closeSuccessModal()">
            <i class="bi bi-printer-fill"></i>
            <span>{{ formLanguage === 'ar' ? 'طباعة' : 'Print' }}</span>
          </button>

          <button class="btn-action btn-download" (click)="downloadGeneratedPDF(); closeSuccessModal()">
            <i class="bi bi-download"></i>
            <span>{{ formLanguage === 'ar' ? 'تحميل' : 'Download' }}</span>
          </button>
        </div>
      </div>

      <div class="modal-footer">
        <button type="button" class="btn-done" (click)="closeSuccessModal()">
          <i class="bi bi-check-lg"></i>
          {{ formLanguage === 'ar' ? 'تم' : 'Done' }}
        </button>
      </div>
    </div>
  </div>

</div>
